# 命令&数据

## 文件上传
./obsutil cp customize_service.py obs://yml-hw201908/output/model/
./obsutil cp ckpt-2019-08-15_09_12-Epoch_001-acc_0.94573-val_acc_0.84812.h5 obs://yml-hw201908/output/model/ckpt.h5

## 进入docker
docker exec -it tf-gpu bash

## 评审账号 ID
d8126a20db13499c82e060007d1e8348

## TODO
[ ]数据扩充到1000张
[x]图像变为299 * 299
[ ]细分类
[x]全连接层改成64
[x]batch normalization
[ ] MaxOut
[x] Noise

# Changlelog

## 8.20
### bottles.0.8.20.1
对瓶子细分类

## 8.19
### exp3.8.18.2 => exp1.8.19.1
droput=0.5 -> droput=0.6 => val_acc = 0.8897
### exp3.8.18.2 => exp2.8.19.1
x = Dense(128, activation='relu')(x) -> x = Dense(128)(x) => 0.8890
### exp3.8.18.2 => exp3.8.19.1
输入添加高斯噪声 => 超级慢
### exp3.8.18.2 => exp4.8.19.1
dropout转BatchNormalization  => val_acc=0.8897
```
x = Dense(128, activation='relu')(x)
x = BatchNormalization()(x)
```
### exp2.8.18.3 => exp2.8.19.2
224 -> 299 => val_acc = val_acc = 0.9117
### exp3.8.17.1 => exp3.8.19.2
224 -> 299 => val_acc = 0.8859
### exp3.8.19.2 => exp1.8.19.2
dropout0.3 => val_acc = 0.8914
### exp3 => exp4.8.19.2
mobilenet_v2 => val_acc = 0.8432




## 8.18
### exp1.8.17.3 => exp1.8.18.1
lr = 1e-5 -> 1e-6 => val_acc = 0.8754，超级慢
### exp2.8.16.2 => exp2.8.18.1
迁移学习 block6~14 => val_acc = 0.8737，过拟合
### exp1.8.17.3 => exp3.8.18.1
val_acc = 0.8897,Score = 0.899676   ！！！！！！
```
x = Dense(128, activation='relu')(x)
x=Dropout(0.3)(x)
```
### exp1.8.17.3 => exp4.8.18.1
val_acc = 0.8863
```
x=Dropout(0.3)(x)
x = Dense(128, activation='relu')(x)
```

### exp1.8.17.3 => exp2.8.18.2
Dense(128, activation='relu') -> Dense(64, activation='relu')
Adam(lr=1e-5) -> Adam(lr=1e-4) => 0.8683，过拟合，验证集得分越来越低

### exp1.8.17.3 => exp1.8.18.2
preprocess_v4 => val_acc = 0.8921
### exp3.8.18.1 => exp2.8.18.3
preprocess_v4 => val_acc = 0.8927
### exp3.8.18.1 => exp3.8.18.2
preprocess_v4,droput=0.5 => val_acc = 0.8944 ,Score = 0.897446 ？？？？？？
### exp3.8.18.1 => exp4.8.18.2
preprocess_v4 => val_acc = 0.8876
```
x=Dropout(0.3)(x)
x = Dense(128, activation='relu')(x)
x=Dropout(0.3)(x)
```

## 8.17

### preprocess => prerocess_v3
BICUBIC -> LANCZOS, 每类固定6000样本

### exp1 => exp1.8.17.1
使用preprocess_v3的数据训练 => 0.8535

### exp2.8.16.2 => exp2.8.17.1
使用preprocess_v3的数据训练

### exp3 => exp3.8.17.1
使用preprocess_v3的数据训练 => val_acc = 0.874, Score=0.870 

### exp2.8.16.2 => exp4.8.17.1
使用preprocess_v3的数据训练, 迁移学习 block6~14 => val_acc = 0.824


### exp2 => exp2.8.17.2
NASNetMobile -> Resnet50 => val_acc = 0.81
### exp1 => exp1.8.17.2
InceptionResNetV2 -> ResNet101
### exp3.8.17.1 => exp3.8.17.2
删除最后的全连接层
### exp3.8.17.1 => exp2.8.17.3
lr = 1e-4 -> 1e-3

---------------------------------以上废了
### exp3.8.17.1 => exp1.8.17.3
lr = 1e-4 -> 1e-5 => val_acc = 0.8873, Score = 0.8988   ！！！！！
### exp3.8.17.1 => exp2.8.17.4
Adam(lr=1e-4) -> SGD(lr=0.0001, momentum=0.9) => 训练极慢
### exp3.8.17.1 => exp3.8.17.3
Dense(128, activation='relu') -> Dense(512, activation='relu') =>  0.8653 过拟合，验证集得分越来越低
### exp3.8.17.1 => exp4.8.17.2
修改全连接层 => 0.8737 过拟合，验证集得分越来越低
```
x = Dense(512, activation='relu')(x)
x=Dropout(0.5)(x)
x = Dense(128, activation='relu')(x)
```
### exp3.8.17.1 => exp2.8.17.5
修改全连接层 => 0.873 过拟合，验证集得分越来越低
```
x = Dense(512, activation='relu')(x)
x=Dropout(0.3)(x)
x = Dense(128, activation='relu')(x)
x=Dropout(0.3)(x)
```

## 8.16

### exp1 => exp1.8.16:
GlobalAveragePooling2D -> GlobalMaxPooling2D => val_acc = 0.834
GlobalMaxPooling2D -> Flatten => val_acc = 0.8305

### exp2 => exp2.8.16
NASNetMobile -> Xception, imagenet -> None => val_acc = 0.4


### exp3 => exp3.8.16
GlobalAveragePooling2D -> GlobalMaxPooling2D => val_acc = 0.843

### exp3 => exp3.8.16.2
Dense(128, activation='relu') -> Dense(1024, activation='relu') => val_acc = 0.8425

### exp3 => exp2.8.16.2
迁移学习 block10~14 => 0.8201

### exp3 => exp4.8.16
迁移学习 block13~14 => val_acc = 0.8096


## 8.15
exp1 - InceptionResNetV2 => val_acc = 0.8431
exp2 - NASNetMobile => val_acc = 0.80
exp3 - Xception => val_acc = 0.8481，Score=0.847183
exp4 - NASNetLarge => pass




